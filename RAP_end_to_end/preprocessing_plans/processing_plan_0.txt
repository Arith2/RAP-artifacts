# dense feature
df["int_0"] = df["int_0"].fill_null(0)
df["int_1"] = df["int_1"].fill_null(0)
df["int_2"] = df["int_2"].fill_null(0)
df["int_3"] = df["int_3"].fill_null(0)
df["int_4"] = df["int_4"].fill_null(0)
df["int_5"] = df["int_5"].fill_null(0)
df["int_6"] = df["int_6"].fill_null(0)
df["int_7"] = df["int_7"].fill_null(0)
df["int_8"] = df["int_8"].fill_null(0)
df["int_9"] = df["int_9"].fill_null(0)
df["int_10"] = df["int_10"].fill_null(0)
df["int_11"] = df["int_11"].fill_null(0)
df["int_12"] = df["int_12"].fill_null(0)

# sparse feature
df["cat_0"] = df["cat_0"].fill_null(0)
df["cat_1"] = df["cat_1"].fill_null(0)
df["cat_2"] = df["cat_2"].fill_null(0)
df["cat_3"] = df["cat_3"].fill_null(0)
df["cat_4"] = df["cat_4"].fill_null(0)
df["cat_5"] = df["cat_5"].fill_null(0)
df["cat_6"] = df["cat_6"].fill_null(0)
df["cat_7"] = df["cat_7"].fill_null(0)
df["cat_8"] = df["cat_8"].fill_null(0)
df["cat_9"] = df["cat_9"].fill_null(0)
df["cat_10"] = df["cat_10"].fill_null(0)
df["cat_11"] = df["cat_11"].fill_null(0)
df["cat_12"] = df["cat_12"].fill_null(0)
df["cat_13"] = df["cat_13"].fill_null(0)
df["cat_14"] = df["cat_14"].fill_null(0)
df["cat_15"] = df["cat_15"].fill_null(0)
df["cat_16"] = df["cat_16"].fill_null(0)
df["cat_17"] = df["cat_17"].fill_null(0)
df["cat_18"] = df["cat_18"].fill_null(0)
df["cat_19"] = df["cat_19"].fill_null(0)
df["cat_20"] = df["cat_20"].fill_null(0)
df["cat_21"] = df["cat_21"].fill_null(0)
df["cat_22"] = df["cat_22"].fill_null(0)
df["cat_23"] = df["cat_23"].fill_null(0)
df["cat_24"] = df["cat_24"].fill_null(0)
df["cat_25"] = df["cat_25"].fill_null(0)

# construct a sparse index from a dense one
df["bucketize_cat_26"] = functional.bucketize(df["int_0"], [0.5, 1.0, 1.5])

# sparse feature
df["cat_0"] = functional.sigrid_hash(df["cat_0"], 0, 1460)
df["cat_1"] = functional.sigrid_hash(df["cat_1"], 0, 583)
df["cat_2"] = functional.sigrid_hash(df["cat_2"], 0, 10131227)
df["cat_3"] = functional.sigrid_hash(df["cat_3"], 0, 2202608)
df["cat_4"] = functional.sigrid_hash(df["cat_4"], 0, 305)
df["cat_5"] = functional.sigrid_hash(df["cat_5"], 0, 24)
df["cat_6"] = functional.sigrid_hash(df["cat_6"], 0, 12517)
df["cat_7"] = functional.sigrid_hash(df["cat_7"], 0, 633)
df["cat_8"] = functional.sigrid_hash(df["cat_8"], 0, 3)
df["cat_9"] = functional.sigrid_hash(df["cat_9"], 0, 93145)
df["cat_10"] = functional.sigrid_hash(df["cat_10"], 0, 5683)
df["cat_11"] = functional.sigrid_hash(df["cat_11"], 0, 8351593)
df["cat_12"] = functional.sigrid_hash(df["cat_12"], 0, 3194)
df["cat_13"] = functional.sigrid_hash(df["cat_13"], 0, 27)
df["cat_14"] = functional.sigrid_hash(df["cat_14"], 0, 14992)
df["cat_15"] = functional.sigrid_hash(df["cat_15"], 0, 5461306)
df["cat_16"] = functional.sigrid_hash(df["cat_16"], 0, 10)
df["cat_17"] = functional.sigrid_hash(df["cat_17"], 0, 5652)
df["cat_18"] = functional.sigrid_hash(df["cat_18"], 0, 2173)
df["cat_19"] = functional.sigrid_hash(df["cat_19"], 0, 4)
df["cat_20"] = functional.sigrid_hash(df["cat_20"], 0, 7046547)
df["cat_21"] = functional.sigrid_hash(df["cat_21"], 0, 18)
df["cat_22"] = functional.sigrid_hash(df["cat_22"], 0, 15)
df["cat_23"] = functional.sigrid_hash(df["cat_23"], 0, 286181)
df["cat_24"] = functional.sigrid_hash(df["cat_24"], 0, 105)
df["cat_25"] = functional.sigrid_hash(df["cat_25"], 0, 142572)

df["cat_0"] = functional.firstx(df["cat_0"], 1)
df["cat_1"] = functional.firstx(df["cat_1"], 1)
df["cat_2"] = functional.firstx(df["cat_2"], 1)
df["cat_3"] = functional.firstx(df["cat_3"], 1)
df["cat_4"] = functional.firstx(df["cat_4"], 1)
df["cat_5"] = functional.firstx(df["cat_5"], 1)
df["cat_6"] = functional.firstx(df["cat_6"], 1)
df["cat_7"] = functional.firstx(df["cat_7"], 1)
df["cat_8"] = functional.firstx(df["cat_8"], 1)
df["cat_9"] = functional.firstx(df["cat_9"], 1)
df["cat_10"] = functional.firstx(df["cat_10"], 1)
df["cat_11"] = functional.firstx(df["cat_11"], 1)
df["cat_12"] = functional.firstx(df["cat_12"], 1)
df["cat_13"] = functional.firstx(df["cat_13"], 1)
df["cat_14"] = functional.firstx(df["cat_14"], 1)
df["cat_15"] = functional.firstx(df["cat_15"], 1)
df["cat_16"] = functional.firstx(df["cat_16"], 1)
df["cat_17"] = functional.firstx(df["cat_17"], 1)
df["cat_18"] = functional.firstx(df["cat_18"], 1)
df["cat_19"] = functional.firstx(df["cat_19"], 1)
df["cat_20"] = functional.firstx(df["cat_20"], 1)
df["cat_21"] = functional.firstx(df["cat_21"], 1)
df["cat_22"] = functional.firstx(df["cat_22"], 1)
df["cat_23"] = functional.firstx(df["cat_23"], 1)
df["cat_24"] = functional.firstx(df["cat_24"], 1)
df["cat_25"] = functional.firstx(df["cat_25"], 1)


# dense feature
df["int_0"] = functional.logit(df["int_0"], 1e-5)
df["int_1"] = functional.logit(df["int_1"], 1e-5)
df["int_2"] = functional.logit(df["int_2"], 1e-5)
df["int_3"] = functional.logit(df["int_3"], 1e-5)
df["int_4"] = functional.logit(df["int_4"], 1e-5)
df["int_5"] = functional.logit(df["int_5"], 1e-5)
df["int_6"] = functional.logit(df["int_6"], 1e-5)
df["int_7"] = functional.logit(df["int_7"], 1e-5)
df["int_8"] = functional.logit(df["int_8"], 1e-5)
df["int_9"] = functional.logit(df["int_9"], 1e-5)
df["int_10"] = functional.logit(df["int_10"], 1e-5)
df["int_11"] = functional.logit(df["int_11"], 1e-5)
df["int_12"] = functional.logit(df["int_12"], 1e-5)

